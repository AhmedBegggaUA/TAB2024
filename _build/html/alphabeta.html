

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>12. Alpha-Beta Pruning &#8212; Técnicas y Algoritmos de Búsqueda IA</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'alphabeta';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="13. Assignment 06/25" href="ExamC3of2025.html" />
    <link rel="prev" title="11. Game Theory and Adversarial Search" href="minimax.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Técnicas y Algoritmos de Búsqueda IA - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Técnicas y Algoritmos de Búsqueda IA - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    TAB2025
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">NP-Hardness and Graph Matching</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="topic1.html">1. NP-Complete Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="topic2.html">2. Simulated and Deterministic Annealing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Puzzles and Rubik</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="topic3.html">3. Heuristic Search</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Game Searching</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="topic4.html">4. Game Search</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="practice_1_1.html">5. Introduction to the practical part of TAB2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="practice_1_2.html">6. Graph Construction for Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="practice_1_3.html">7. Graph Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="practice_1_4.html">8. Graph Matching with Topological Features</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="practice_2.html">9. Clustering</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice 3</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="practice_3.html">10. Pacman with AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="minimax.html">11. Game Theory and Adversarial Search</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">12. Alpha-Beta Pruning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exam solutions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ExamC3of2025.html">13. Assignment 06/25</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Falphabeta.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/alphabeta.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Alpha-Beta Pruning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-minimax-with-alpha-beta-pruning">12.1. Optimizing Minimax with Alpha-Beta Pruning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">12.1.1. Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-alpha-beta-pruning">12.1.2. What is Alpha-Beta Pruning?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pruning-principle">12.1.3. The Pruning Principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-beta-algorithm">12.1.4. Alpha-Beta Algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-to-pacman">12.2. Application to Pacman</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#game-structure-in-pacman">12.2.1. Game Structure in Pacman</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agent-order">12.2.2. Agent Order</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-example-depth-2-with-2-ghosts">12.2.3. Detailed Example: Depth 2 with 2 Ghosts</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">12.2.3.1. Initial Setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-alpha-beta-game-tree-depth-2">12.2.3.2. The Alpha-Beta Game Tree (Depth 2)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-by-step-alpha-beta-execution">12.2.4. Step-by-Step Alpha-Beta Execution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-state">12.2.4.1. Initial State</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-1-pacman-north">12.2.4.2. Branch 1: Pacman NORTH</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-2-pacman-east">12.2.4.3. Branch 2: Pacman EAST</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-3-pacman-south">12.2.4.4. Branch 3: Pacman SOUTH</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#final-decision">12.2.4.5. Final Decision</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-for-pacman">12.2.5. Implementation for Pacman</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-execution-trace">12.2.6. Complete Execution Trace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-alpha-beta-insights">12.2.7. Key Alpha-Beta Insights</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-minimizer-levels">12.2.7.1. 1. Multiple Minimizer Levels</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cascading-pruning">12.2.7.2. 2. Cascading Pruning</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#agent-specific-alpha-beta">12.2.7.3. 3. Agent-Specific Alpha-Beta</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#order-matters">12.2.7.4. 4. Order Matters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-beta-conditions">12.2.7.5. 5. Alpha-Beta Conditions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maintaining-bounds">12.2.7.6. 6. Maintaining Bounds</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-minimax-vs-alpha-beta">12.2.8. Comparison: Minimax vs Alpha-Beta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-note">12.2.9. Important Note</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="alpha-beta-pruning">
<h1><span class="section-number">12. </span>Alpha-Beta Pruning<a class="headerlink" href="#alpha-beta-pruning" title="Permalink to this heading">#</a></h1>
<section id="optimizing-minimax-with-alpha-beta-pruning">
<h2><span class="section-number">12.1. </span>Optimizing Minimax with Alpha-Beta Pruning<a class="headerlink" href="#optimizing-minimax-with-alpha-beta-pruning" title="Permalink to this heading">#</a></h2>
<section id="introduction">
<h3><span class="section-number">12.1.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h3>
<p>While the Minimax algorithm guarantees optimal decisions, it has a significant drawback: it explores <strong>every possible branch</strong> of the game tree, which can be computationally expensive. <strong>Alpha-Beta Pruning</strong> is an optimization technique that can significantly reduce the number of nodes evaluated without affecting the final result.</p>
</section>
<section id="what-is-alpha-beta-pruning">
<h3><span class="section-number">12.1.2. </span>What is Alpha-Beta Pruning?<a class="headerlink" href="#what-is-alpha-beta-pruning" title="Permalink to this heading">#</a></h3>
<p>Alpha-Beta Pruning works by <strong>eliminating branches</strong> that cannot possibly influence the final decision. It maintains two values:</p>
<ul class="simple">
<li><p><strong>Alpha (α)</strong>: The best value that the <strong>maximizer</strong> (Pacman) has found so far</p></li>
<li><p><strong>Beta (β)</strong>: The best value that the <strong>minimizer</strong> (Ghost) has found so far</p></li>
</ul>
</section>
<section id="the-pruning-principle">
<h3><span class="section-number">12.1.3. </span>The Pruning Principle<a class="headerlink" href="#the-pruning-principle" title="Permalink to this heading">#</a></h3>
<p>The key insight is:</p>
<blockquote>
<div><p>If at any point we discover that the current path will not be chosen, we can stop exploring it.</p>
</div></blockquote>
<p><strong>Specifically:</strong></p>
<ul class="simple">
<li><p><strong>In MAX nodes</strong>: If the value becomes ≥ β, prune (the minimizer won’t allow this path)</p></li>
<li><p><strong>In MIN nodes</strong>: If the value becomes ≤ α, prune (the maximizer won’t choose this path)</p></li>
</ul>
</section>
<section id="alpha-beta-algorithm">
<h3><span class="section-number">12.1.4. </span>Alpha-Beta Algorithm<a class="headerlink" href="#alpha-beta-algorithm" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">alphabeta</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">is_maximizing_player</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">node</span><span class="o">.</span><span class="n">is_terminal</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">is_maximizing_player</span><span class="p">:</span>
        <span class="n">max_eval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
            <span class="n">eval_score</span> <span class="o">=</span> <span class="n">alphabeta</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">max_eval</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_eval</span><span class="p">,</span> <span class="n">eval_score</span><span class="p">)</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">eval_score</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">beta</span> <span class="o">&lt;=</span> <span class="n">alpha</span><span class="p">:</span>  <span class="c1"># Prune!</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">max_eval</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_eval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
            <span class="n">eval_score</span> <span class="o">=</span> <span class="n">alphabeta</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">min_eval</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min_eval</span><span class="p">,</span> <span class="n">eval_score</span><span class="p">)</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">eval_score</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">beta</span> <span class="o">&lt;=</span> <span class="n">alpha</span><span class="p">:</span>  <span class="c1"># Prune!</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">min_eval</span>
</pre></div>
</div>
</section>
</section>
<section id="application-to-pacman">
<h2><span class="section-number">12.2. </span>Application to Pacman<a class="headerlink" href="#application-to-pacman" title="Permalink to this heading">#</a></h2>
<p>Now we will apply Alpha-Beta pruning to the Pacman game, where:</p>
<ul class="simple">
<li><p><strong>Pacman (Agent 0)</strong>: Maximizing player - wants to maximize score</p></li>
<li><p><strong>Ghosts (Agents 1+)</strong>: Minimizing players - want to minimize Pacman’s score</p></li>
</ul>
<section id="game-structure-in-pacman">
<h3><span class="section-number">12.2.1. </span>Game Structure in Pacman<a class="headerlink" href="#game-structure-in-pacman" title="Permalink to this heading">#</a></h3>
<p>In Pacman Alpha-Beta with <strong>2 ghosts</strong>:</p>
<ul class="simple">
<li><p>One <strong>ply</strong> = Pacman moves + Ghost 1 moves + Ghost 2 moves</p></li>
<li><p><strong>Depth 1</strong> = One complete ply (Pacman + both ghosts)</p></li>
<li><p><strong>Depth 2</strong> = Two complete plies</p></li>
</ul>
</section>
<section id="agent-order">
<h3><span class="section-number">12.2.2. </span>Agent Order<a class="headerlink" href="#agent-order" title="Permalink to this heading">#</a></h3>
<p>The agents take turns in this specific order:</p>
<ol class="arabic simple">
<li><p><strong>Pacman (Agent 0)</strong> - MAX player</p></li>
<li><p><strong>Ghost 1 (Agent 1)</strong> - MIN player</p></li>
<li><p><strong>Ghost 2 (Agent 2)</strong> - MIN player</p></li>
<li><p>Back to <strong>Pacman (Agent 0)</strong> - depth increments</p></li>
</ol>
<p>This cycle repeats until the maximum depth is reached.</p>
</section>
<section id="detailed-example-depth-2-with-2-ghosts">
<h3><span class="section-number">12.2.3. </span>Detailed Example: Depth 2 with 2 Ghosts<a class="headerlink" href="#detailed-example-depth-2-with-2-ghosts" title="Permalink to this heading">#</a></h3>
<p>Let’s walk through a complete example with <strong>depth = 2</strong> and <strong>2 ghosts</strong>:</p>
<section id="initial-setup">
<h4><span class="section-number">12.2.3.1. </span>Initial Setup<a class="headerlink" href="#initial-setup" title="Permalink to this heading">#</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Game</span> <span class="n">State</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Pacman</span> <span class="n">at</span> <span class="n">position</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="o">-</span> <span class="n">Ghost</span> <span class="mi">1</span> <span class="n">at</span> <span class="n">position</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="o">-</span> <span class="n">Ghost</span> <span class="mi">2</span> <span class="n">at</span> <span class="n">position</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">-</span> <span class="n">Food</span> <span class="n">dot</span> <span class="n">at</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="o">-</span> <span class="n">Evaluation</span> <span class="n">scores</span> <span class="k">for</span> <span class="n">different</span> <span class="n">scenarios</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">Pacman</span> <span class="n">eats</span> <span class="n">food</span><span class="p">:</span> <span class="o">+</span><span class="mi">10</span>
  <span class="o">*</span> <span class="n">Ghost</span> <span class="n">catches</span> <span class="n">Pacman</span><span class="p">:</span> <span class="o">-</span><span class="mi">500</span>
  <span class="o">*</span> <span class="n">Normal</span> <span class="n">move</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">(</span><span class="n">time</span> <span class="n">penalty</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="the-alpha-beta-game-tree-depth-2">
<h4><span class="section-number">12.2.3.2. </span>The Alpha-Beta Game Tree (Depth 2)<a class="headerlink" href="#the-alpha-beta-game-tree-depth-2" title="Permalink to this heading">#</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                    ROOT: Pacman Turn (MAX)
                   α=-∞, β=+∞
                   /          |          \
               NORTH        EAST        SOUTH
              Score: ?    Score: ?    Score: ?
                |            |            |
        
    DEPTH 0: Ghost1 Turn (MIN)   DEPTH 0: Ghost1 Turn (MIN)   DEPTH 0: Ghost1 Turn (MIN)
           α=-∞, β=+∞               α=+1, β=+∞               α=+1, β=+∞
         /    |    \                  /    |    \                  /    ✗    ✗
      N     E     S                N     E     S                N    PRUNED
      |     |     |                |     |     |                |         
      
    DEPTH 0: Ghost2 Turn (MIN)   DEPTH 0: Ghost2 Turn (MIN)   DEPTH 0: Ghost2 Turn (MIN)
           α=-∞, β=+∞               α=+1, β=+∞               α=+1, β=+∞
         /    |    \                  /    |    ✗                |
      N     E     S                N     E   PRUNED            N → returns -1
      |     |     |                |     |                    ↓
      |     |     |                |     |                  PRUNE!
      
    DEPTH 1: Pacman Turn (MAX)   DEPTH 1: Pacman Turn (MAX)   ALL REMAINING
           α=-∞, β=+1               α=+1, β=+1               BRANCHES
    /    |    \                  /    |    \                PRUNED
   N    E    S                  N    E    S                
   |    |    |                  |    |    |                
   
   [... Ghost1 → Ghost2 → Evaluate ...]     
   
 DEPTH 2: EVALUATE            DEPTH 2: EVALUATE      
   +1  +2  +3                   +1   +1  +1          
       ↓                           ↓
   Returns +1                   Returns +1
</pre></div>
</div>
<p>Legend:</p>
<ul class="simple">
<li><p>✗ = Pruned branches (not evaluated)</p></li>
<li><p>α, β = Alpha-beta values at each node</p></li>
<li><p>Numbers = Final evaluation scores</p></li>
</ul>
</section>
</section>
<section id="step-by-step-alpha-beta-execution">
<h3><span class="section-number">12.2.4. </span>Step-by-Step Alpha-Beta Execution<a class="headerlink" href="#step-by-step-alpha-beta-execution" title="Permalink to this heading">#</a></h3>
<section id="initial-state">
<h4><span class="section-number">12.2.4.1. </span>Initial State<a class="headerlink" href="#initial-state" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Root</strong>: α = -∞, β = +∞</p></li>
<li><p>Pacman tries actions in order: NORTH, EAST, SOUTH</p></li>
</ul>
</section>
<section id="branch-1-pacman-north">
<h4><span class="section-number">12.2.4.2. </span>Branch 1: Pacman NORTH<a class="headerlink" href="#branch-1-pacman-north" title="Permalink to this heading">#</a></h4>
<p><strong>1.1. Pacman moves NORTH</strong></p>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(1,</span> <span class="pre">0,</span> <span class="pre">-∞,</span> <span class="pre">+∞,</span> <span class="pre">False)</span></code> (Ghost 1’s turn)</p></li>
</ul>
<p><strong>1.2. Ghost 1’s turn (MIN node)</strong></p>
<ul class="simple">
<li><p>α = -∞, β = +∞</p></li>
<li><p>Ghost 1 tries NORTH first → Through complete evaluation → returns +3</p></li>
<li><p>β = min(+∞, +3) = +3</p></li>
<li><p>Ghost 1 tries EAST → returns +2</p></li>
<li><p>β = min(+3, +2) = +2</p></li>
<li><p>Ghost 1 tries SOUTH → returns +1</p></li>
<li><p>β = min(+2, +1) = +1</p></li>
</ul>
<p><strong>1.3. Ghost 1 returns +1</strong></p>
<ul class="simple">
<li><p>Back to root: α = max(-∞, +1) = <strong>+1</strong></p></li>
</ul>
</section>
<section id="branch-2-pacman-east">
<h4><span class="section-number">12.2.4.3. </span>Branch 2: Pacman EAST<a class="headerlink" href="#branch-2-pacman-east" title="Permalink to this heading">#</a></h4>
<p><strong>2.1. Pacman moves EAST</strong></p>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(1,</span> <span class="pre">0,</span> <span class="pre">+1,</span> <span class="pre">+∞,</span> <span class="pre">False)</span></code> (Ghost 1’s turn)</p></li>
<li><p><strong>Note</strong>: α is now +1 from previous branch!</p></li>
</ul>
<p><strong>2.2. Ghost 1’s turn (MIN node)</strong></p>
<ul class="simple">
<li><p>α = +1, β = +∞</p></li>
<li><p>Ghost 1 tries NORTH → through Ghost 2 → returns +2</p></li>
<li><p>β = min(+∞, +2) = +2</p></li>
</ul>
<p><strong>2.3. Ghost 1 tries EAST</strong></p>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(2,</span> <span class="pre">0,</span> <span class="pre">+1,</span> <span class="pre">+2,</span> <span class="pre">False)</span></code> (Ghost 2’s turn)</p></li>
</ul>
<p><strong>2.4. Ghost 2’s turn (MIN node)</strong></p>
<ul class="simple">
<li><p>α = +1, β = +2</p></li>
<li><p>Ghost 2 tries NORTH → through complete depth evaluation → returns +1</p></li>
<li><p>β = min(+2, +1) = +1</p></li>
<li><p>Ghost 2 tries EAST → returns +1</p></li>
<li><p>β = min(+1, +1) = +1</p></li>
<li><p><strong>Check: β(+1) ≤ α(+1)? YES!</strong></p></li>
<li><p><strong>PRUNE! Skip Ghost 2 SOUTH</strong></p></li>
</ul>
<p><strong>2.5. Ghost 2 returns +1</strong></p>
<ul class="simple">
<li><p>Back to Ghost 1: β = min(+2, +1) = +1</p></li>
<li><p><strong>Check: β(+1) ≤ α(+1)? YES!</strong></p></li>
<li><p><strong>PRUNE! Skip Ghost 1 SOUTH</strong></p></li>
</ul>
<p><strong>2.6. Ghost 1 returns +1</strong></p>
<ul class="simple">
<li><p>Back to root: α = max(+1, +1) = +1</p></li>
</ul>
</section>
<section id="branch-3-pacman-south">
<h4><span class="section-number">12.2.4.4. </span>Branch 3: Pacman SOUTH<a class="headerlink" href="#branch-3-pacman-south" title="Permalink to this heading">#</a></h4>
<p><strong>3.1. Pacman moves SOUTH</strong></p>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(1,</span> <span class="pre">0,</span> <span class="pre">+1,</span> <span class="pre">+∞,</span> <span class="pre">False)</span></code> (Ghost 1’s turn)</p></li>
<li><p><strong>Note</strong>: α is still +1!</p></li>
</ul>
<p><strong>3.2. Ghost 1’s turn (MIN node)</strong></p>
<ul class="simple">
<li><p>α = +1, β = +∞</p></li>
<li><p>Ghost 1 tries NORTH → Ghost 2 turn</p></li>
</ul>
<p><strong>3.3. Ghost 2’s turn (MIN node)</strong></p>
<ul class="simple">
<li><p>α = +1, β = +∞</p></li>
<li><p>Ghost 2 tries NORTH → Pacman (depth=1) → eventually returns <strong>-1</strong></p></li>
<li><p>v = min(+∞, -1) = -1</p></li>
<li><p>β = min(+∞, -1) = -1</p></li>
<li><p><strong>Check: v(-1) &lt; α(+1)? YES!</strong></p></li>
<li><p><strong>PRUNE! Return -1 immediately</strong></p></li>
</ul>
<p><strong>3.4. Ghost 2 returns -1</strong></p>
<ul class="simple">
<li><p>Back to Ghost 1: β = min(+∞, -1) = -1</p></li>
<li><p><strong>Check: β(-1) ≤ α(+1)? YES!</strong></p></li>
<li><p><strong>PRUNE! Skip Ghost 1’s EAST and SOUTH</strong></p></li>
</ul>
<p><strong>3.5. Ghost 1 returns -1</strong></p>
<ul class="simple">
<li><p>Back to root: α remains +1</p></li>
</ul>
</section>
<section id="final-decision">
<h4><span class="section-number">12.2.4.5. </span>Final Decision<a class="headerlink" href="#final-decision" title="Permalink to this heading">#</a></h4>
<p><strong>Root Node Final State:</strong></p>
<ul class="simple">
<li><p>NORTH: +1</p></li>
<li><p>EAST: +1 ← TIE</p></li>
<li><p>SOUTH: -1 (pruned early)</p></li>
</ul>
<p><strong>Pacman chooses NORTH or EAST</strong> (both give +1)</p>
</section>
</section>
<section id="implementation-for-pacman">
<h3><span class="section-number">12.2.5. </span>Implementation for Pacman<a class="headerlink" href="#implementation-for-pacman" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AlphaBetaAgent</span><span class="p">(</span><span class="n">MultiAgentSearchAgent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Minimax agent with alpha-beta pruning</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">getAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gameState</span><span class="p">:</span> <span class="n">GameState</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the alpha-beta action using self.depth and self.evaluationFunction</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">alphabeta</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">gameState</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
            <span class="c1"># Base case: Check if the game is over or if we&#39;ve reached the maximum depth</span>
            <span class="k">if</span> <span class="n">gameState</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="ow">or</span> <span class="n">gameState</span><span class="o">.</span><span class="n">isLose</span><span class="p">()</span> <span class="ow">or</span> <span class="n">depth</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluationFunction</span><span class="p">(</span><span class="n">gameState</span><span class="p">)</span>

            <span class="c1"># Pacman (maximizer) is agentIndex 0</span>
            <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">maxValue</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">gameState</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
            <span class="c1"># Ghosts (minimizer) are agentIndex 1 or higher</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">minValue</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">gameState</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">maxValue</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">gameState</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
            <span class="c1"># Initialize max value</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
            <span class="c1"># Get Pacman&#39;s legal actions</span>
            <span class="n">legalActions</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">legalActions</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluationFunction</span><span class="p">(</span><span class="n">gameState</span><span class="p">)</span>

            <span class="c1"># Iterate through all possible actions and update alpha-beta values</span>
            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">legalActions</span><span class="p">:</span>
                <span class="n">successor</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
                <span class="n">v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">alphabeta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">successor</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>  <span class="c1"># Ghosts start at index 1</span>
                <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">beta</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">v</span>  <span class="c1"># Prune the remaining branches</span>
                <span class="n">alpha</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="k">def</span> <span class="nf">minValue</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">gameState</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
            <span class="c1"># Initialize min value</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
            <span class="c1"># Get the current agent&#39;s legal actions (ghosts)</span>
            <span class="n">legalActions</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">legalActions</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluationFunction</span><span class="p">(</span><span class="n">gameState</span><span class="p">)</span>

            <span class="c1"># Get the next agent&#39;s index and check if we need to increase depth</span>
            <span class="n">nextAgent</span> <span class="o">=</span> <span class="n">agentIndex</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">nextAgent</span> <span class="o">==</span> <span class="n">gameState</span><span class="o">.</span><span class="n">getNumAgents</span><span class="p">():</span>
                <span class="n">nextAgent</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Go back to Pacman</span>
                <span class="n">depth</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Increase the depth since we&#39;ve gone through all agents</span>

            <span class="c1"># Iterate through all possible actions and update alpha-beta values</span>
            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">legalActions</span><span class="p">:</span>
                <span class="n">successor</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">agentIndex</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
                <span class="n">v</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">alphabeta</span><span class="p">(</span><span class="n">nextAgent</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">successor</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">v</span>  <span class="c1"># Prune the remaining branches</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="c1"># Pacman (agentIndex 0) will choose the action with the best alpha-beta score</span>
        <span class="n">bestAction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">bestScore</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">gameState</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>  <span class="c1"># Pacman&#39;s legal actions</span>
            <span class="n">successor</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">alphabeta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">successor</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>  <span class="c1"># Start with Ghost 1, depth 0</span>
            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">bestScore</span><span class="p">:</span>
                <span class="n">bestScore</span> <span class="o">=</span> <span class="n">score</span>
                <span class="n">bestAction</span> <span class="o">=</span> <span class="n">action</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bestAction</span>
</pre></div>
</div>
</section>
<section id="complete-execution-trace">
<h3><span class="section-number">12.2.6. </span>Complete Execution Trace<a class="headerlink" href="#complete-execution-trace" title="Permalink to this heading">#</a></h3>
<p>Let’s trace the alpha-beta execution step by step with 2 ghosts:</p>
<p><strong>Initial Call</strong>: <code class="docutils literal notranslate"><span class="pre">getAction(gameState)</span></code></p>
<p><strong>1. Try Pacman action: NORTH</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">generateSuccessor(0,</span> <span class="pre">NORTH)</span></code> → New state with Pacman at (1,2)</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(1,</span> <span class="pre">0,</span> <span class="pre">successor_state,</span> <span class="pre">-∞,</span> <span class="pre">+∞)</span></code></p></li>
</ul>
<p><strong>2. Ghost 1’s turn (agentIndex=1, depth=0)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">minValue(1,</span> <span class="pre">0,</span> <span class="pre">state,</span> <span class="pre">-∞,</span> <span class="pre">+∞)</span></code> called</p></li>
<li><p>Ghost 1 legal actions: [NORTH, EAST, SOUTH]</p></li>
</ul>
<p><strong>2.1 Try Ghost 1 action: NORTH</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">generateSuccessor(1,</span> <span class="pre">NORTH)</span></code> → Ghost 1 at (3,0)</p></li>
<li><p>nextAgent = 2, nextDepth = 0</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(2,</span> <span class="pre">0,</span> <span class="pre">successor_state,</span> <span class="pre">-∞,</span> <span class="pre">+∞)</span></code></p></li>
</ul>
<p><strong>2.1.1 Ghost 2’s turn (agentIndex=2, depth=0)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">minValue(2,</span> <span class="pre">0,</span> <span class="pre">state,</span> <span class="pre">-∞,</span> <span class="pre">+∞)</span></code> called</p></li>
<li><p>Ghost 2 legal actions: [NORTH, EAST, SOUTH]</p></li>
</ul>
<p><strong>2.1.1.1 Try Ghost 2 NORTH</strong> → Eventually returns +3</p>
<ul class="simple">
<li><p>v = min(+∞, +3) = +3</p></li>
<li><p>β = min(+∞, +3) = +3</p></li>
</ul>
<p><strong>2.1.1.2 Try Ghost 2 EAST</strong> → Eventually returns +2</p>
<ul class="simple">
<li><p>v = min(+3, +2) = +2</p></li>
<li><p>β = min(+3, +2) = +2</p></li>
</ul>
<p><strong>2.1.1.3 Try Ghost 2 SOUTH</strong> → Eventually returns +1</p>
<ul class="simple">
<li><p>v = min(+2, +1) = +1</p></li>
<li><p>β = min(+2, +1) = +1</p></li>
</ul>
<p><strong>2.1.1 Ghost 2 returns +1</strong></p>
<p><strong>2.1 Back to Ghost 1 NORTH</strong> → value +1</p>
<ul class="simple">
<li><p>v = min(+∞, +1) = +1</p></li>
<li><p>β = min(+∞, +1) = +1</p></li>
</ul>
<p><strong>2.2 Try Ghost 1 action: EAST</strong> → Eventually returns +2</p>
<ul class="simple">
<li><p>v = min(+1, +2) = +1</p></li>
<li><p>β = min(+1, +2) = +1</p></li>
</ul>
<p><strong>2.3 Try Ghost 1 action: SOUTH</strong> → Eventually returns +3</p>
<ul class="simple">
<li><p>v = min(+1, +3) = +1</p></li>
<li><p>β = min(+1, +3) = +1</p></li>
</ul>
<p><strong>3. Ghost 1 returns minimum</strong>: +1</p>
<ul class="simple">
<li><p>Back to root: α = max(-∞, +1) = +1</p></li>
</ul>
<p><strong>4. Try Pacman action: EAST</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">generateSuccessor(0,</span> <span class="pre">EAST)</span></code> → New state with Pacman at (2,1)</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(1,</span> <span class="pre">0,</span> <span class="pre">successor_state,</span> <span class="pre">+1,</span> <span class="pre">+∞)</span></code></p></li>
</ul>
<p><strong>5. Ghost 1’s turn (agentIndex=1, depth=0)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">minValue(1,</span> <span class="pre">0,</span> <span class="pre">state,</span> <span class="pre">+1,</span> <span class="pre">+∞)</span></code> called</p></li>
<li><p><strong>Note</strong>: α is now +1 from previous branch!</p></li>
</ul>
<p><strong>5.1 Try Ghost 1 action: NORTH</strong> → Through Ghost 2 → returns +2</p>
<ul class="simple">
<li><p>v = min(+∞, +2) = +2</p></li>
<li><p>β = min(+∞, +2) = +2</p></li>
</ul>
<p><strong>5.2 Try Ghost 1 action: EAST</strong> → Through Ghost 2 → returns +1</p>
<ul class="simple">
<li><p>v = min(+2, +1) = +1</p></li>
<li><p>β = min(+2, +1) = +1</p></li>
<li><p><strong>Check: β(+1) ≤ α(+1)? YES!</strong></p></li>
<li><p><strong>PRUNE! Skip Ghost 1 SOUTH action</strong></p></li>
</ul>
<p><strong>6. Ghost 1 returns +1</strong></p>
<ul class="simple">
<li><p>Back to root: α = max(+1, +1) = +1</p></li>
</ul>
<p><strong>7. Try Pacman action: SOUTH</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">generateSuccessor(0,</span> <span class="pre">SOUTH)</span></code> → New state with Pacman at (1,0)</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(1,</span> <span class="pre">0,</span> <span class="pre">successor_state,</span> <span class="pre">+1,</span> <span class="pre">+∞)</span></code></p></li>
</ul>
<p><strong>8. Ghost 1’s turn (agentIndex=1, depth=0)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">minValue(1,</span> <span class="pre">0,</span> <span class="pre">state,</span> <span class="pre">+1,</span> <span class="pre">+∞)</span></code> called</p></li>
</ul>
<p><strong>8.1 Try Ghost 1 action: NORTH</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">generateSuccessor(1,</span> <span class="pre">NORTH)</span></code> → Ghost 1 at (3,0)</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">alphabeta(2,</span> <span class="pre">0,</span> <span class="pre">successor_state,</span> <span class="pre">+1,</span> <span class="pre">+∞)</span></code></p></li>
</ul>
<p><strong>8.1.1 Ghost 2’s turn (agentIndex=2, depth=0)</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">minValue(2,</span> <span class="pre">0,</span> <span class="pre">state,</span> <span class="pre">+1,</span> <span class="pre">+∞)</span></code> called</p></li>
</ul>
<p><strong>8.1.1.1 Try Ghost 2 NORTH</strong> → Eventually returns -1</p>
<ul class="simple">
<li><p>v = min(+∞, -1) = -1</p></li>
<li><p>β = min(+∞, -1) = -1</p></li>
<li><p><strong>Check: v(-1) &lt; α(+1)? YES!</strong></p></li>
<li><p><strong>PRUNE! Return -1 immediately</strong></p></li>
</ul>
<p><strong>8.1 Ghost 2 returns -1</strong></p>
<ul class="simple">
<li><p>Back to Ghost 1: v = min(+∞, -1) = -1</p></li>
<li><p>β = min(+∞, -1) = -1</p></li>
<li><p><strong>Check: β(-1) ≤ α(+1)? YES!</strong></p></li>
<li><p><strong>PRUNE! Skip Ghost 1’s EAST and SOUTH actions</strong></p></li>
</ul>
<p><strong>9. Ghost 1 returns -1</strong></p>
<ul class="simple">
<li><p>Back to root: α = max(+1, -1) = +1</p></li>
</ul>
<p><strong>10. Final decision</strong>: max(NORTH:+1, EAST:+1, SOUTH:-1) = NORTH or EAST (tie)</p>
</section>
<section id="key-alpha-beta-insights">
<h3><span class="section-number">12.2.7. </span>Key Alpha-Beta Insights<a class="headerlink" href="#key-alpha-beta-insights" title="Permalink to this heading">#</a></h3>
<section id="multiple-minimizer-levels">
<h4><span class="section-number">12.2.7.1. </span>1. Multiple Minimizer Levels<a class="headerlink" href="#multiple-minimizer-levels" title="Permalink to this heading">#</a></h4>
<p>With 2 ghosts, we have two consecutive MIN levels:</p>
<ul class="simple">
<li><p>Ghost 1 minimizes over Ghost 2’s choices</p></li>
<li><p>Ghost 2 minimizes over Pacman’s future choices</p></li>
<li><p>Both can trigger pruning independently</p></li>
</ul>
</section>
<section id="cascading-pruning">
<h4><span class="section-number">12.2.7.2. </span>2. Cascading Pruning<a class="headerlink" href="#cascading-pruning" title="Permalink to this heading">#</a></h4>
<p>When Ghost 2 triggers pruning (β ≤ α), it not only skips Ghost 2’s remaining moves but can also cause Ghost 1 to skip its remaining moves.</p>
</section>
<section id="agent-specific-alpha-beta">
<h4><span class="section-number">12.2.7.3. </span>3. Agent-Specific Alpha-Beta<a class="headerlink" href="#agent-specific-alpha-beta" title="Permalink to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In MIN nodes for both ghosts: prune when β ≤ α</span>
<span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">v</span>  <span class="c1"># Don&#39;t explore remaining actions</span>

<span class="c1"># Update beta for current ghost</span>
<span class="n">beta</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="order-matters">
<h4><span class="section-number">12.2.7.4. </span>4. Order Matters<a class="headerlink" href="#order-matters" title="Permalink to this heading">#</a></h4>
<p>The order of exploring children affects pruning efficiency:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Better move ordering → more pruning</span>
<span class="c1"># In practice, try &quot;promising&quot; moves first</span>
</pre></div>
</div>
</section>
<section id="alpha-beta-conditions">
<h4><span class="section-number">12.2.7.5. </span>5. Alpha-Beta Conditions<a class="headerlink" href="#alpha-beta-conditions" title="Permalink to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In MAX nodes: prune when v ≥ β</span>
<span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">beta</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">v</span>

<span class="c1"># In MIN nodes: prune when v ≤ α  </span>
<span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">v</span>
</pre></div>
</div>
</section>
<section id="maintaining-bounds">
<h4><span class="section-number">12.2.7.6. </span>6. Maintaining Bounds<a class="headerlink" href="#maintaining-bounds" title="Permalink to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># MAX node updates alpha</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="c1"># MIN node updates beta</span>
<span class="n">beta</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="comparison-minimax-vs-alpha-beta">
<h3><span class="section-number">12.2.8. </span>Comparison: Minimax vs Alpha-Beta<a class="headerlink" href="#comparison-minimax-vs-alpha-beta" title="Permalink to this heading">#</a></h3>
<p><strong>Minimax</strong>: Evaluates <strong>81 nodes</strong> in the tree (3^4 for all combinations with 2 ghosts)
<strong>Alpha-Beta</strong>: Evaluates <strong>43 nodes</strong> in the tree
<strong>Savings</strong>: 47% fewer evaluations!</p>
<p>The savings are even more dramatic with the two-ghost scenario. Notice how:</p>
<ol class="arabic simple">
<li><p><strong>Early pruning in Ghost 1 EAST branch</strong>: When β ≤ α, we skip Ghost 1’s remaining moves</p></li>
<li><p><strong>Massive pruning in SOUTH branch</strong>: Both ghosts get pruned early due to the improved α value</p></li>
</ol>
</section>
<section id="important-note">
<h3><span class="section-number">12.2.9. </span>Important Note<a class="headerlink" href="#important-note" title="Permalink to this heading">#</a></h3>
<p><strong>Alpha-Beta pruning returns the exact same result</strong> as regular Minimax - it’s just faster! The pruned branches are guaranteed to not affect the optimal decision. With multiple ghosts, the algorithm creates more opportunities for pruning, especially when the first few evaluations establish good alpha and beta bounds that help eliminate large portions of the search tree.</p>
<p>The Minimax algorithm with Alpha-Beta pruning guarantees that Pacman will make the best possible decision, assuming all ghosts also play optimally to minimize Pacman’s score, but does so with significantly improved computational efficiency.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="minimax.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">11. </span>Game Theory and Adversarial Search</p>
      </div>
    </a>
    <a class="right-next"
       href="ExamC3of2025.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">13. </span>Assignment 06/25</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-minimax-with-alpha-beta-pruning">12.1. Optimizing Minimax with Alpha-Beta Pruning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">12.1.1. Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-alpha-beta-pruning">12.1.2. What is Alpha-Beta Pruning?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pruning-principle">12.1.3. The Pruning Principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-beta-algorithm">12.1.4. Alpha-Beta Algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-to-pacman">12.2. Application to Pacman</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#game-structure-in-pacman">12.2.1. Game Structure in Pacman</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agent-order">12.2.2. Agent Order</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-example-depth-2-with-2-ghosts">12.2.3. Detailed Example: Depth 2 with 2 Ghosts</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">12.2.3.1. Initial Setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-alpha-beta-game-tree-depth-2">12.2.3.2. The Alpha-Beta Game Tree (Depth 2)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-by-step-alpha-beta-execution">12.2.4. Step-by-Step Alpha-Beta Execution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-state">12.2.4.1. Initial State</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-1-pacman-north">12.2.4.2. Branch 1: Pacman NORTH</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-2-pacman-east">12.2.4.3. Branch 2: Pacman EAST</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-3-pacman-south">12.2.4.4. Branch 3: Pacman SOUTH</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#final-decision">12.2.4.5. Final Decision</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-for-pacman">12.2.5. Implementation for Pacman</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-execution-trace">12.2.6. Complete Execution Trace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-alpha-beta-insights">12.2.7. Key Alpha-Beta Insights</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-minimizer-levels">12.2.7.1. 1. Multiple Minimizer Levels</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cascading-pruning">12.2.7.2. 2. Cascading Pruning</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#agent-specific-alpha-beta">12.2.7.3. 3. Agent-Specific Alpha-Beta</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#order-matters">12.2.7.4. 4. Order Matters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-beta-conditions">12.2.7.5. 5. Alpha-Beta Conditions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maintaining-bounds">12.2.7.6. 6. Maintaining Bounds</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-minimax-vs-alpha-beta">12.2.8. Comparison: Minimax vs Alpha-Beta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-note">12.2.9. Important Note</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Francisco Javier Escolano Ruiz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>