

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>3. Introduction to the practical part of TAB2025 &#8212; Técnicas y Algoritmos de Búsqueda IA</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'practice_intro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="2. Simulated and Deterministic Annealing" href="topic2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Técnicas y Algoritmos de Búsqueda IA - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Técnicas y Algoritmos de Búsqueda IA - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    TAB2025
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">NP-Hardness and Graph Matching</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="topic1.html">1. NP-Complete Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="topic2.html">2. Simulated and Deterministic Annealing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice 1</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Introduction to the practical part of TAB2025</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpractice_intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/practice_intro.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to the practical part of TAB2025</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">3. Introduction to the practical part of TAB2025</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#welcome-to-the-practice-material-of-tab2025">3.1. Welcome to the practice material of TAB2025!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-we-are-going-to-start">3.1.1. How we are going to start?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structures-and-problems">3.1.2. Data Structures and Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#annotated-images-willow-object-class-dataset">3.1.2.1. Annotated Images (Willow-Object-Class Dataset)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#key-features">3.1.2.1.1. Key Features</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-dataset-from-here">3.1.2.1.1.1. Download the dataset from here</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-of-feature-matching-examples">4. Grid of Feature Matching Examples</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-start-with-visualizing-the-data">4.1. Let’s start with visualizing the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-images-and-keypoints">4.1.1. Visualizing the Images and Keypoints</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">4.1.2. Exercise</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">4.1.2.1. Exercise 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">4.1.2.2. Exercise 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">4.1.2.3. Exercise 3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">4.1.2.4. Exercise 4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">4.2. Summary</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-the-practical-part-of-tab2025">
<h1><span class="section-number">3. </span>Introduction to the practical part of TAB2025<a class="headerlink" href="#introduction-to-the-practical-part-of-tab2025" title="Permalink to this heading">#</a></h1>
<section id="welcome-to-the-practice-material-of-tab2025">
<h2><span class="section-number">3.1. </span>Welcome to the practice material of TAB2025!<a class="headerlink" href="#welcome-to-the-practice-material-of-tab2025" title="Permalink to this heading">#</a></h2>
<p>In this part of the course, you will learn search techniques and algorithms. All the algorithms you that you will implement in this part are based on the search algorithms that you have learned in the theoretical part of the course. The main goal of this part is to give you a hands-on experience of implementing search algorithms and understanding how they work. We will especially focus on those problems whose nature is NP hard. And we will try to implement a series of techniques or euristics that are able to give us the solution or an approximation to it in an optimal time.</p>
<section id="how-we-are-going-to-start">
<h3><span class="section-number">3.1.1. </span>How we are going to start?<a class="headerlink" href="#how-we-are-going-to-start" title="Permalink to this heading">#</a></h3>
<p>As an engineer, you will have to set up your environment to start working on the practical part of the course. We will use Python as the programming language for this part of the course. You can use any IDE or text editor to write your code. However, we recommend using Jupyter Notebook as it is a very good tool for writing and running code. You can also use Google Colab to run your code in the cloud. This last option is not recommended as it may be slow and you may have to wait for a long time to get the results.</p>
<p>The following libraries are required to run the code in this part of the course:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">networkx</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">easydict</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">requests</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tqdm</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">appdirs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PIL</span></code></p></li>
</ul>
</section>
<section id="data-structures-and-problems">
<h3><span class="section-number">3.1.2. </span>Data Structures and Problems<a class="headerlink" href="#data-structures-and-problems" title="Permalink to this heading">#</a></h3>
<p>In this course we will begin wth the problem of graph matching. We will implement a series of algorithms to solve this problem. We will start with the brute force algorithm and then we will implement a series of heuristics to solve the problem in an optimal time. We will also see all the important variations of the problem (image mathching, subgraph detection, etc) and how to solve them. Regarding the data, in this course we will have to types, annotated images and synthetic data.</p>
<section id="annotated-images-willow-object-class-dataset">
<h4><span class="section-number">3.1.2.1. </span>Annotated Images (Willow-Object-Class Dataset)<a class="headerlink" href="#annotated-images-willow-object-class-dataset" title="Permalink to this heading">#</a></h4>
<p>The Willow-Object-Class Dataset is a comprehensive image collection specifically designed for object classification and visual relationship recognition tasks in computer vision. Created to advance research in fine-grained object recognition and interaction understanding, this dataset contains images across multiple object categories with detailed annotations.</p>
<section id="key-features">
<h5><span class="section-number">3.1.2.1.1. </span>Key Features<a class="headerlink" href="#key-features" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Contains 5 common object categories: Car, Face, Duck, Motorbike, and Winebottle</p></li>
<li><p>Each category includes around 40-108 images collected from Flickr and PASCAL VOC 2007</p></li>
<li><p>All images are annotated with detailed keypoints specific to each object class</p></li>
<li><p>Provides ground truth annotations for object parts and their relationships</p></li>
<li><p>Images show objects from various viewpoints and in different contexts</p></li>
<li><p>Includes challenging scenarios like occlusion and varying lighting conditions</p></li>
</ul>
<section id="download-the-dataset-from-here">
<h6><span class="section-number">3.1.2.1.1.1. </span>Download the dataset from <a class="reference external" href="https://huggingface.co/heatingma/pygmtools/resolve/main/WILLOW-ObjectClass_dataset.zip">here</a><a class="headerlink" href="#download-the-dataset-from-here" title="Permalink to this heading">#</a></h6>
</section>
</section>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="grid-of-feature-matching-examples">
<h1><span class="section-number">4. </span>Grid of Feature Matching Examples<a class="headerlink" href="#grid-of-feature-matching-examples" title="Permalink to this heading">#</a></h1>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><img alt="Example 1" src="_images/matching_Example.png" /></p></th>
<th class="head text-center"><p><img alt="Example 2" src="_images/matching_Example_2.png" /></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>* Car Matching*</p></td>
<td class="text-center"><p><em>Face Matching</em></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><img alt="Example 3" src="_images/matching_Example_3.png" /></p></td>
<td class="text-center"><p><img alt="Example 4" src="_images/matching_Example_4.png" /></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><em>Motorbike Matching</em></p></td>
<td class="text-center"><p><em>Duck Matching</em></p></td>
</tr>
</tbody>
</table>
<section id="let-s-start-with-visualizing-the-data">
<h2><span class="section-number">4.1. </span>Let’s start with visualizing the data<a class="headerlink" href="#let-s-start-with-visualizing-the-data" title="Permalink to this heading">#</a></h2>
<p>In this part of the course, we will start by visualizing the data. We will use the Willow-Object-Class Dataset to visualize the data. We will also see how to load the data and how to use it in our algorithms. We will also see how to visualize the data using the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>          <span class="c1"># Import NumPy for numerical operations and array handling</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>      <span class="c1"># Import PIL (Python Imaging Library) for image processing</span>
<span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="nn">sio</span>     <span class="c1"># Import SciPy&#39;s IO module for reading .mat files</span>

<span class="c1"># Define target size for image resizing (256x256 pixels)</span>
<span class="n">obj_resize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>

<span class="c1"># Load duck images from the Willow Object Dataset</span>
<span class="c1"># These images will be used for feature matching</span>
<span class="n">img1</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./data/WillowObject/WILLOW-ObjectClass/Duck/060_0000.png&#39;</span><span class="p">)</span>  <span class="c1"># Load first duck image</span>
<span class="n">img2</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./data/WillowObject/WILLOW-ObjectClass/Duck/060_0010.png&#39;</span><span class="p">)</span>  <span class="c1"># Load second duck image</span>

<span class="c1"># Load keypoint annotations from corresponding .mat files</span>
<span class="c1"># &#39;pts_coord&#39; contains the coordinates of manually annotated keypoints for each image</span>
<span class="c1"># Convert the MATLAB format to NumPy arrays for easier processing</span>
<span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;./data/WillowObject/WILLOW-ObjectClass/Duck/060_0000.mat&#39;</span><span class="p">)[</span><span class="s1">&#39;pts_coord&#39;</span><span class="p">])</span>  <span class="c1"># Keypoints for first image</span>
<span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;./data/WillowObject/WILLOW-ObjectClass/Duck/060_0010.mat&#39;</span><span class="p">)[</span><span class="s1">&#39;pts_coord&#39;</span><span class="p">])</span>  <span class="c1"># Keypoints for second image</span>

<span class="c1"># Scale keypoint coordinates to match the new image dimensions</span>
<span class="c1"># This ensures keypoints remain aligned when images are resized</span>
<span class="n">kpts1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpts1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">obj_resize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Scale x-coordinates of first image keypoints</span>
<span class="n">kpts1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpts1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">obj_resize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">img1</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Scale y-coordinates of first image keypoints</span>
<span class="n">kpts2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpts2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">obj_resize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">img2</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Scale x-coordinates of second image keypoints</span>
<span class="n">kpts2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpts2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">obj_resize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">img2</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Scale y-coordinates of second image keypoints</span>

<span class="c1"># Resize both images to the target size (256x256)</span>
<span class="c1"># Using BILINEAR interpolation for smooth resizing</span>
<span class="n">img1</span> <span class="o">=</span> <span class="n">img1</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">obj_resize</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">)</span>  <span class="c1"># Resize first image</span>
<span class="n">img2</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">obj_resize</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">)</span>  <span class="c1"># Resize second image</span>
</pre></div>
</div>
<section id="visualizing-the-images-and-keypoints">
<h3><span class="section-number">4.1.1. </span>Visualizing the Images and Keypoints<a class="headerlink" href="#visualizing-the-images-and-keypoints" title="Permalink to this heading">#</a></h3>
<p>Now that we have loaded the images and keypoints, let’s visualize them using the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library. We will plot the images along with the annotated keypoints to see how they align with the objects in the images.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_image_with_graph</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kpt</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Function to visualize an image with keypoints and optional graph connections</span>
<span class="sd">   </span>
<span class="sd">   Parameters:</span>
<span class="sd">   - img: Input image to be displayed</span>
<span class="sd">   - kpt: Keypoints array with shape (2, N) where N is number of keypoints</span>
<span class="sd">   - A: Optional adjacency matrix for drawing connections between keypoints</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="c1"># Display the input image</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
   
   <span class="c1"># Plot keypoints as white dots with black edges</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">kpt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kpt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
   
   <span class="c1"># If an adjacency matrix is provided, draw connections between keypoints</span>
   <span class="k">if</span> <span class="n">A</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
       <span class="c1"># Iterate through non-zero elements in adjacency matrix</span>
       <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">as_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
           <span class="c1"># Draw black lines between connected keypoints</span>
           <span class="c1"># idx[0] is start point index, idx[1] is end point index</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">kpt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">kpt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="c1"># x-coordinates of line</span>
                   <span class="p">(</span><span class="n">kpt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">kpt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span>  <span class="c1"># y-coordinates of line</span>
                   <span class="s1">&#39;k-&#39;</span><span class="p">)</span>                               <span class="c1"># black solid line style</span>

<span class="c1"># Create a figure with specific size (8 inches width, 4 inches height)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Create first subplot for Image 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>          <span class="c1"># 1 row, 2 columns, first position</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Image 1&#39;</span><span class="p">)</span>          <span class="c1"># Set title for first subplot</span>
<span class="n">plot_image_with_graph</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">)</span>  <span class="c1"># Plot first image with its keypoints</span>

<span class="c1"># Create second subplot for Image 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>          <span class="c1"># 1 row, 2 columns, second position</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Image 2&#39;</span><span class="p">)</span>          <span class="c1"># Set title for second subplot</span>
<span class="n">plot_image_with_graph</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">)</span>  <span class="c1"># Plot second image with its keypoints</span>
</pre></div>
</div>
<p>The result should be two images side by side, each with keypoints annotated on them. The keypoints are represented as white dots with black edges.</p>
<figure class="align-default" id="duck-matching">
<a class="reference internal image-reference" href="_images/duck_matching.png"><img alt="_images/duck_matching.png" src="_images/duck_matching.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Visualizing the Duck Images with Keypoints</span><a class="headerlink" href="#duck-matching" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="exercise">
<h3><span class="section-number">4.1.2. </span>Exercise<a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h3>
<p>Now it is your turn to visualize the images and keypoints for the other object categories in the Willow-Object-Class Dataset. You can use the code provided above as a reference and modify it to load and display images from different categories like Car, Face, Motorbike, and Winebottle. You can also experiment with different image pairs within the same category to see how the keypoints align with the objects in the images.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As you can see, the following exercises are very repetitive. We recommend you to create a function that loads the images and keypoints and another function that plots them. This way you can reuse the code and avoid repetition. <strong>Bare in mind that you will need this kind of funtionalities in the next exercises.</strong></p>
</div>
<section id="exercise-1">
<h4><span class="section-number">4.1.2.1. </span>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h4>
<p>Visualize the images and keypoints for the Car category in the Willow-Object-Class Dataset. Load 8 images from the Car category and display them along with their annotated keypoints.</p>
</section>
<section id="exercise-2">
<h4><span class="section-number">4.1.2.2. </span>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h4>
<p>Visualize the images and keypoints for the Face category in the Willow-Object-Class Dataset. Load 8 images from the Face category and display them along with their annotated keypoints.</p>
</section>
<section id="exercise-3">
<h4><span class="section-number">4.1.2.3. </span>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this heading">#</a></h4>
<p>Visualize the images and keypoints for the Motorbike category in the Willow-Object-Class Dataset. Load 8 images from the Motorbike category and display them along with their annotated keypoints.</p>
</section>
<section id="exercise-4">
<h4><span class="section-number">4.1.2.4. </span>Exercise 4<a class="headerlink" href="#exercise-4" title="Permalink to this heading">#</a></h4>
<p>Visualize the images and keypoints for the Winebottle category in the Willow-Object-Class Dataset. Load 8 images from the Winebottle category and display them along with their annotated keypoints.</p>
</section>
</section>
</section>
<section id="summary">
<h2><span class="section-number">4.2. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>In this part of the course, we learned how to visualize the data from the Willow-Object-Class Dataset. We loaded images and their corresponding keypoints, resized the images, and plotted them using the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library. We also saw how to connect keypoints using an adjacency matrix to visualize relationships between keypoints. This visualization is essential for understanding how keypoints align with objects in the images and how they can be used for feature matching and object recognition tasks.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="topic2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Simulated and Deterministic Annealing</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">3. Introduction to the practical part of TAB2025</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#welcome-to-the-practice-material-of-tab2025">3.1. Welcome to the practice material of TAB2025!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-we-are-going-to-start">3.1.1. How we are going to start?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structures-and-problems">3.1.2. Data Structures and Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#annotated-images-willow-object-class-dataset">3.1.2.1. Annotated Images (Willow-Object-Class Dataset)</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#key-features">3.1.2.1.1. Key Features</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-dataset-from-here">3.1.2.1.1.1. Download the dataset from here</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-of-feature-matching-examples">4. Grid of Feature Matching Examples</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-start-with-visualizing-the-data">4.1. Let’s start with visualizing the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-images-and-keypoints">4.1.1. Visualizing the Images and Keypoints</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">4.1.2. Exercise</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">4.1.2.1. Exercise 1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">4.1.2.2. Exercise 2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">4.1.2.3. Exercise 3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">4.1.2.4. Exercise 4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">4.2. Summary</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Francisco Javier Escolano Ruiz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>